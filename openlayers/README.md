modify from v3.20.1 write by Olivier Sechet <https://github.com/osechet> to fit the V4.0.1 version
